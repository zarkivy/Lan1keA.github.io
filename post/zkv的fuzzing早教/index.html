<!DOCTYPE html>
<html lang="" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='from 0 to 1'><title>ZKVçš„Fuzzingæ—©æ•™</title>

<link rel='canonical' href='https://cerr.cc/post/zkv%E7%9A%84fuzzing%E6%97%A9%E6%95%99/'>

<link rel="stylesheet" href="/scss/style.min.e75bab105855f77caa94de85bd0b7a889920eb03fa3048257f51f59c063a674d.css"><meta property='og:title' content='ZKVçš„Fuzzingæ—©æ•™'>
<meta property='og:description' content='from 0 to 1'>
<meta property='og:url' content='https://cerr.cc/post/zkv%E7%9A%84fuzzing%E6%97%A9%E6%95%99/'>
<meta property='og:site_name' content='LanikeA'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Fuzzing' /><meta property='article:published_time' content='2022-05-11T13:57:01&#43;08:00'/><meta property='article:modified_time' content='2022-05-11T13:57:01&#43;08:00'/><meta property='og:image' content='https://lcamtuf.coredump.cx/afl/afl_screen.png' />
<meta name="twitter:title" content="ZKVçš„Fuzzingæ—©æ•™">
<meta name="twitter:description" content="from 0 to 1"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://lcamtuf.coredump.cx/afl/afl_screen.png' />
    <link rel="shortcut icon" href="favicon.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu83ce41192ed66b608a10477eb7108e0c_128714_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸŸ</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">LanikeA</a></h1>
            <h2 class="site-description">Yet anothor cyber nyandog.</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/lan1kea'
                        target="_blank"
                        title="GitHub"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='mailto:lan1kea@outlook.com'
                        target="_blank"
                        title="Mail"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail-opened" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <polyline points="3 9 12 15 21 9 12 3 3 9" />
  <path d="M21 9v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10" />
  <line x1="3" y1="19" x2="9" y2="13" />
  <line x1="15" y1="13" x2="21" y2="19" />
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/lan1kea'
                        target="_blank"
                        title="Twitter"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archive</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/love/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-heart" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" />
</svg>

                
                <span>Love</span>
            </a>
        </li>
        
        

        <li >
            <a href='/friends/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-friends" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <circle cx="7" cy="5" r="2" />
  <path d="M5 22v-5l-1 -1v-4a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4l-1 1v5" />
  <circle cx="17" cy="5" r="2" />
  <path d="M15 22v-4h-2l2 -6a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1l2 6h-2v4" />
</svg>

                
                <span>Friends</span>
            </a>
        </li>
        
        

        <li >
            <a href='/utils/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Utils</span>
            </a>
        </li>
        
        

        <li >
            <a href='/board/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <rect x="8" y="8" width="12" height="12" rx="2" />
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2" />
</svg>

                
                <span>Board</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/zkv%E7%9A%84fuzzing%E6%97%A9%E6%95%99/">
                
                    <img src="https://lcamtuf.coredump.cx/afl/afl_screen.png" loading="lazy" alt="Featured image of post ZKVçš„Fuzzingæ—©æ•™" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/" >
                è¯¾å ‚ç¬”è®°
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/zkv%E7%9A%84fuzzing%E6%97%A9%E6%95%99/">ZKVçš„Fuzzingæ—©æ•™</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            from 0 to 1
        </h3>
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 11, 2022</time>
            </div>
        

        
    </footer>
    

    
</div>
</header>

    <section class="article-content">
    
    
    <h1 id="x00-æ—©æ•™æ•™ç¨‹">\x00 æ—©æ•™æ•™ç¨‹</h1>
<h2 id="æ•™ç¨‹">æ•™ç¨‹</h2>
<p><a class="link" href="https://github.com/google/fuzzing"  target="_blank" rel="noopener"
    >è°·æ­Œçš„Fuzzingæ•™ç¨‹</a></p>
<p><a class="link" href="https://www.fuzzingbook.org/"  target="_blank" rel="noopener"
    >Fuzzingbook</a></p>
<h2 id="è¯¾ç¨‹">è¯¾ç¨‹</h2>
<p><a class="link" href="https://pascal-group.bitbucket.io/teaching.html"  target="_blank" rel="noopener"
    >å—äº¬å¤§å­¦ï¼šè½¯ä»¶åˆ†æ</a></p>
<p><a class="link" href="https://www.bilibili.com/video/BV1b7411K7P4/?spm_id_from=333.788.videocard.1"  target="_blank" rel="noopener"
    >å—äº¬å¤§å­¦ï¼šè½¯ä»¶åˆ†æè¯¾ç¨‹è§†é¢‘</a></p>






    


<div class="video-wrapper">
    <iframe src="https://player.bilibili.com/player.html?as_wide=1&amp;high_quality=1&amp;page=1&bvid=BV1b7411K7P4"
            scrolling="no"
            frameborder="no"
            framespacing="0"
            allowfullscreen="true"
    >
    </iframe>
</div>

<h2 id="åšæ–‡">åšæ–‡</h2>
<p><a class="link" href="https://riusksk.me/2020/01/22/Fuzzing%E6%8A%80%E6%9C%AF%E5%8F%91%E5%B1%95%E7%9A%84%E8%BF%9930%E5%B9%B4/"  target="_blank" rel="noopener"
    >FuzzingæŠ€æœ¯å‘å±•çš„è¿™30å¹´</a></p>
<p><a class="link" href="https://riusksk.me/2019/07/14/%e4%b8%80%e4%ba%9b%e5%80%bc%e5%be%97%e5%ad%a6%e4%b9%a0%e7%9a%84Fuzzer%e5%bc%80%e6%ba%90%e9%a1%b9%e7%9b%ae/"  target="_blank" rel="noopener"
    >ä¸€äº›å€¼å¾—å­¦ä¹ çš„Fuzzerå¼€æºé¡¹ç›®</a></p>
<p><a class="link" href="https://blog.flanker017.me/fuzzing%e6%88%98%e4%ba%89-%e4%bb%8e%e5%88%80%e5%89%91%e5%bc%93%e6%96%a7%e5%88%b0%e6%98%9f%e7%90%83%e5%a4%a7%e6%88%98/"  target="_blank" rel="noopener"
    >Fuzzingæˆ˜äº‰: ä»åˆ€å‰‘å¼“æ–§åˆ°æ˜Ÿçƒå¤§æˆ˜</a></p>
<p><a class="link" href="https://blog.flanker017.me/fuzzing%e6%88%98%e4%ba%89%e7%b3%bb%e5%88%97%e4%b9%8b%e4%ba%8c%ef%bc%9a%e4%b8%8d%e7%95%8f%e6%b5%ae%e4%ba%91%e9%81%ae%e6%9c%9b%e7%9c%bc/"  target="_blank" rel="noopener"
    >Fuzzingæˆ˜äº‰ç³»åˆ—ä¹‹äºŒï¼šä¸ç•æµ®äº‘é®æœ›çœ¼</a></p>
<h2 id="ç»ƒå…µåœº">ç»ƒå…µåœº</h2>
<p><a class="link" href="https://github.com/antonio-morales/Fuzzing101"  target="_blank" rel="noopener"
    >Fuzzing101</a></p>
<p><a class="link" href="https://github.com/mykter/afl-training"  target="_blank" rel="noopener"
    >afl-training</a></p>
<h2 id="å…µå™¨">å…µå™¨</h2>
<p><a class="link" href="https://github.com/google/AFL"  target="_blank" rel="noopener"
    >AFL</a></p>
<p><a class="link" href="https://github.com/AFLplusplus/AFLplusplus"  target="_blank" rel="noopener"
    >AFLplusplus</a></p>
<h2 id="èµ„æº">èµ„æº</h2>
<p><a class="link" href="https://github.com/secfigo/Awesome-Fuzzing"  target="_blank" rel="noopener"
    >https://github.com/secfigo/Awesome-Fuzzing</a></p>
<h2 id="è®ºæ–‡">è®ºæ–‡</h2>
<h3 id="å¼€å±±">å¼€å±±</h3>
<p>1988å¹´ï¼Œåœ¨å¨æ–¯åº·æ˜Ÿå¤§å­¦Barton Milleræ•™æˆçš„è®¡ç®—æœºå®éªŒè¯¾ä¸Šï¼Œé¦–æ¬¡æå‡º<code>Fuzzç”Ÿæˆå™¨</code>(Fuzz Generator)çš„æ¦‚å¿µï¼Œç”¨äºæµ‹è¯•Unixç¨‹åºçš„å¥å£®æ€§ï¼Œå³ç”¨éšæœºæ•°æ®æ¥æµ‹è¯•ç¨‹åºç›´è‡³å´©æºƒã€‚å› æ­¤ï¼ŒBarton Milleræ•™æˆä¹Ÿè¢«å¤šæ•°äººå°Šç§°ä¸ºâ€æ¨¡ç³Šæµ‹è¯•ä¹‹çˆ¶â€ã€‚</p>
<p><a class="link" href="http://pages.cs.wisc.edu/~bart/fuzz/CS736-Projects-f1988.pdf"  target="_blank" rel="noopener"
    >http://pages.cs.wisc.edu/~bart/fuzz/CS736-Projects-f1988.pdf</a></p>
<h3 id="èµ„æ–™">èµ„æ–™</h3>
<ul>
<li><a class="link" href="https://docs.google.com/presentation/d/1Ap3eUIo4RrI_9GAGfn2Q0RKtBPNmGhI1DZlivdcFKPo/edit#slide=id.p33"  target="_blank" rel="noopener"
    >https://docs.google.com/presentation/d/1Ap3eUIo4RrI_9GAGfn2Q0RKtBPNmGhI1DZlivdcFKPo/edit#slide=id.p33</a></li>
<li><a class="link" href="https://trustfoundry.net/2020/01/22/introduction-to-triaging-fuzzer-generated-crashes/"  target="_blank" rel="noopener"
    >https://trustfoundry.net/2020/01/22/introduction-to-triaging-fuzzer-generated-crashes/</a></li>
<li><a class="link" href="https://github.com/antonio-morales/EkoParty_Advanced_Fuzzing_Workshop"  target="_blank" rel="noopener"
    >https://github.com/antonio-morales/EkoParty_Advanced_Fuzzing_Workshop</a></li>
<li><a class="link" href="https://docs.google.com/presentation/d/1FgcMRv_pwgOh1yL5y4GFsl1ozFwd6PMNGlMi2ONkGec/edit#slide=id.g190ecf0108_0_130"  target="_blank" rel="noopener"
    >https://docs.google.com/presentation/d/1FgcMRv_pwgOh1yL5y4GFsl1ozFwd6PMNGlMi2ONkGec/edit#slide=id.g190ecf0108_0_130</a></li>
<li><a class="link" href="https://vimeo.com/129701495"  target="_blank" rel="noopener"
    >https://vimeo.com/129701495</a></li>
<li><a class="link" href="https://bughunters.google.com/about/patch-rewards"  target="_blank" rel="noopener"
    >https://bughunters.google.com/about/patch-rewards</a></li>
<li><a class="link" href="https://www.vegardno.net/2017/03/fuzzing-openssh-daemon-using-afl.html"  target="_blank" rel="noopener"
    >https://www.vegardno.net/2017/03/fuzzing-openssh-daemon-using-afl.html</a></li>
<li><a class="link" href="https://lcamtuf.blogspot.com/2014/11/pulling-jpegs-out-of-thin-air.html"  target="_blank" rel="noopener"
    >https://lcamtuf.blogspot.com/2014/11/pulling-jpegs-out-of-thin-air.html</a></li>
</ul>
<h1 id="x01-å­¦æ­¥è½¦aflåˆæ¢">\x01 å­¦æ­¥è½¦AFLåˆæ¢</h1>
<h2 id="æœ€ç®€å•çš„-fuzzing-demo">æœ€ç®€å•çš„ fuzzing demo</h2>
<p>ä½¿ç”¨AFLï¼Œæ•…å…ˆå®‰è£…ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">git clone https://github.com/google/AFL.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> AFL
</span></span><span class="line"><span class="cl">make -j<span class="sb">`</span>nproc<span class="sb">`</span>
</span></span><span class="line"><span class="cl">sudo make install
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ç€å‡†å¤‡è¢«æµ‹ç¨‹åºæºç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt; </span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;signal.h&gt; </span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="nf">vuln</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;A&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">len</span> <span class="o">==</span> <span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">raise</span><span class="p">(</span><span class="n">SIGSEGV</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;F&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">len</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">raise</span><span class="p">(</span><span class="n">SIGSEGV</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="n">puts</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">nothing happened&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="n">gets</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">vuln</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨afl-gccæ’è£…ç¼–è¯‘ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">afl-gcc vulner.c -o vulner
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‡†å¤‡fuzzingè¾“å…¥ä¸è¾“å‡ºçš„æ–‡ä»¶å¤¹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">mkdir fuzz_in fuzz_out
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ›å»ºä¸¤ä¸ªæ ·ä¾‹è¾“å…¥ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nb">echo</span> -n AAAA &gt; fuzz_in/input_case_1
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e -n <span class="s2">&#34;\x01\x02\x03\x04&#34;</span> &gt; fuzz_in/input_case_2
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯åŠ¨fuzzingï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">afl-fuzz -i fuzz_in -o fuzz_out ./vulner
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ctrl+Cåœæ­¢åï¼Œç”±fuzzing_outä¸­æ‹¿åˆ°fuzzingç»“æœã€‚ç”¨å…¶ä¸­çš„ä¸€ä¸ªcrashè¾“å…¥æµ‹è¯•ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">âœ ./vulner &lt; fuzz_out/crashes/id:000000,sig:06,src:000000,op:havoc,rep:32
</span></span><span class="line"><span class="cl"><span class="m">6666</span>
</span></span><span class="line"><span class="cl">nothing happened
</span></span><span class="line"><span class="cl">*** stack smashing detected ***: terminated
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span>    <span class="m">1541204</span> abort      ./vulner &lt; fuzz_out/crashes/id:000000,sig:06,src:000000,op:havoc,rep:32
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°å‘ç”Ÿäº†æ ˆæº¢å‡ºã€‚</p>
<h2 id="ä¸ºå­¦æ­¥è½¦è£…ä¸Šåä¸ºsanitizersçš„è½®å­">ä¸ºå­¦æ­¥è½¦è£…ä¸Šåä¸ºsanitizersçš„è½®å­</h2>
<p>å€ŸåŠ©äº<a class="link" href="https://github.com/google/sanitizers"  target="_blank" rel="noopener"
    >sanitizers</a>è·å¾—æ›´å¤šå´©æºƒçš„è¯¦ç»†ä¿¡æ¯ï¼š</p>
<p>å¼€å¯<a class="link" href="https://github.com/google/fuzzing/blob/master/docs/ASan"  target="_blank" rel="noopener"
    >AddressSanitizer</a>é‡æ–°ç¼–è¯‘ç¨‹åºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"> afl-clang -fsanitize<span class="o">=</span>address vulner.c -o vulner
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨ä¸Šä¸€éƒ¨åˆ†ç›¸åŒçš„crashè¾“å…¥ç”¨ä¾‹ï¼Œæ¥æµ‹è¯•æ‰“å¼€äº†AddressSanitizerçš„ç¨‹åºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">âœ ./vulner &lt; fuzz_out/crashes/id:000000,sig:06,src:000000,op:havoc,rep:32
</span></span><span class="line"><span class="cl"><span class="o">=================================================================</span>
</span></span><span class="line"><span class="cl"><span class="o">==</span><span class="nv">1541245</span><span class="o">==</span>ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffe9090e564 at pc 0x0000004393cb bp 0x7ffe9090e3a0 sp 0x7ffe9090db28
</span></span><span class="line"><span class="cl">READ of size <span class="m">116</span> at 0x7ffe9090e564 thread T0
</span></span><span class="line"><span class="cl">    <span class="c1">#0 0x4393ca in printf_common(void*, char const*, __va_list_tag*) (/f/lab/fuzzing_baby/vulner+0x4393ca)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#1 0x43af1e in printf (/f/lab/fuzzing_baby/vulner+0x43af1e)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#2 0x4c3418 in main /root/lab/fuzzing_baby/vulner.c:17:5</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#3 0x7f09a7252082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#4 0x41b33d in _start (/f/lab/fuzzing_baby/vulner+0x41b33d)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Address 0x7ffe9090e564 is located in stack of thread T0 at offset <span class="m">132</span> in frame
</span></span><span class="line"><span class="cl">    <span class="c1">#0 0x4c32cf in main /root/lab/fuzzing_baby/vulner.c:14</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  This frame has <span class="m">1</span> object<span class="o">(</span>s<span class="o">)</span>:
</span></span><span class="line"><span class="cl">    <span class="o">[</span>32, 132<span class="o">)</span> <span class="s1">&#39;buf&#39;</span> <span class="o">(</span>line 15<span class="o">)</span> &lt;<span class="o">==</span> Memory access at offset <span class="m">132</span> overflows this variable
</span></span><span class="line"><span class="cl">HINT: this may be a <span class="nb">false</span> positive <span class="k">if</span> your program uses some custom stack unwind mechanism, swapcontext or vfork
</span></span><span class="line"><span class="cl">      <span class="o">(</span>longjmp and C++ exceptions *are* supported<span class="o">)</span>
</span></span><span class="line"><span class="cl">SUMMARY: AddressSanitizer: stack-buffer-overflow <span class="o">(</span>/f/lab/fuzzing_baby/vulner+0x4393ca<span class="o">)</span> in printf_common<span class="o">(</span>void*, char const*, __va_list_tag*<span class="o">)</span>
</span></span><span class="line"><span class="cl">Shadow bytes around the buggy address:
</span></span><span class="line"><span class="cl">  0x100052119c50: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
</span></span><span class="line"><span class="cl">  0x100052119c60: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
</span></span><span class="line"><span class="cl">  0x100052119c70: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
</span></span><span class="line"><span class="cl">  0x100052119c80: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
</span></span><span class="line"><span class="cl">  0x100052119c90: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> f1 f1 f1 <span class="nv">f1</span>
</span></span><span class="line"><span class="cl"><span class="o">=</span>&gt;0x100052119ca0: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00<span class="o">[</span>04<span class="o">]</span>f3 f3 f3
</span></span><span class="line"><span class="cl">  0x100052119cb0: f3 f3 f3 f3 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
</span></span><span class="line"><span class="cl">  0x100052119cc0: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
</span></span><span class="line"><span class="cl">  0x100052119cd0: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
</span></span><span class="line"><span class="cl">  0x100052119ce0: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
</span></span><span class="line"><span class="cl">  0x100052119cf0: <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
</span></span><span class="line"><span class="cl">Shadow byte legend <span class="o">(</span>one shadow byte represents <span class="m">8</span> application bytes<span class="o">)</span>:
</span></span><span class="line"><span class="cl">  Addressable:           <span class="m">00</span>
</span></span><span class="line"><span class="cl">  Partially addressable: <span class="m">01</span> <span class="m">02</span> <span class="m">03</span> <span class="m">04</span> <span class="m">05</span> <span class="m">06</span> <span class="m">07</span>
</span></span><span class="line"><span class="cl">  Heap left redzone:       fa
</span></span><span class="line"><span class="cl">  Freed heap region:       fd
</span></span><span class="line"><span class="cl">  Stack left redzone:      f1
</span></span><span class="line"><span class="cl">  Stack mid redzone:       f2
</span></span><span class="line"><span class="cl">  Stack right redzone:     f3
</span></span><span class="line"><span class="cl">  Stack after <span class="k">return</span>:      f5
</span></span><span class="line"><span class="cl">  Stack use after scope:   f8
</span></span><span class="line"><span class="cl">  Global redzone:          f9
</span></span><span class="line"><span class="cl">  Global init order:       f6
</span></span><span class="line"><span class="cl">  Poisoned by user:        f7
</span></span><span class="line"><span class="cl">  Container overflow:      <span class="nb">fc</span>
</span></span><span class="line"><span class="cl">  Array cookie:            ac
</span></span><span class="line"><span class="cl">  Intra object redzone:    bb
</span></span><span class="line"><span class="cl">  ASan internal:           fe
</span></span><span class="line"><span class="cl">  Left alloca redzone:     ca
</span></span><span class="line"><span class="cl">  Right alloca redzone:    cb
</span></span><span class="line"><span class="cl">  Shadow gap:              <span class="nv">cc</span>
</span></span><span class="line"><span class="cl"><span class="o">==</span><span class="nv">1541245</span><span class="o">==</span>ABORTING
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±æ­¤å¾—åˆ°äº†crashçš„è¯¦ç»†ä¿¡æ¯è¾“å‡ºã€‚</p>
<h2 id="é»‘ç›’æµ‹è¯•qemu-modeæ‹†èµ°æºç ã®è½®å„¿">é»‘ç›’æµ‹è¯•QEMU modeâ€”â€”æ‹†èµ°æºç ã®è½®å„¿</h2>
<p>AFLçš„QEMU modeä¸ä¼šé»˜è®¤å®‰è£…ï¼Œè€Œæ˜¯éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å®‰è£…ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sudo apt install libtool libtool-bin libcapstone-dev
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> AFL/qemu_mode
</span></span><span class="line"><span class="cl">./build_qemu_support.sh
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">sudo make install 
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœé‡åˆ°ç¼–è¯‘é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä»½forkï¼šhttps://github.com/blurbdust/AFL.git</p>
<p>ä¸æ’æ¡©é‡æ–°ç¼–è¯‘ç¨‹åºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">gcc vulner.c -o vulner
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¼€å§‹QEMU modeé»‘ç›’fuzzing</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">afl-fuzz -Q -i fuzz_in -o fuzz_out ./vulner
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="aflå¹¶å‘å­¦æ­¥è½¦çš„å››ç¼¸å¼•æ“">AFLå¹¶å‘â€”â€”å­¦æ­¥è½¦çš„å››ç¼¸å¼•æ“</h2>
<p>é€šè¿‡-MæŒ‡å®šmaster fuzzerè¿›ç¨‹ï¼Œ-SæŒ‡å®šä¸€ç³»åˆ—slave fuzzerè¿›ç¨‹å³å¯ã€‚å››æ ¸æœºå™¨å°±ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">afl-fuzz -i fuzz_in -o fuzz_out -M fuzzer1 ./vulner
</span></span><span class="line"><span class="cl">afl-fuzz -i fuzz_in -o fuzz_out -S fuzzer2 ./vulner
</span></span><span class="line"><span class="cl">afl-fuzz -i fuzz_in -o fuzz_out -S fuzzer3 ./vulner
</span></span><span class="line"><span class="cl">afl-fuzz -i fuzz_in -o fuzz_out -S fuzzer4 ./vulner
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="fuzzing-capstone-using-afl-persistent-mode">Fuzzing capstone using AFL persistent mode</h2>
<p>Refï¼š<a class="link" href="https://toastedcornflakes.github.io/articles/fuzzing_capstone_with_afl.html"  target="_blank" rel="noopener"
    >https://toastedcornflakes.github.io/articles/fuzzing_capstone_with_afl.html</a></p>
<p>è·å–å—å®³è€…capstoneï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">git clone https://github.com/capstone-engine/capstone.git
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="x02-libfuzzeråˆæ¢">\x02 libFuzzeråˆæ¢</h1>
<h2 id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</h2>
<blockquote>
<p>LibFuzzer is an in-process, coverage-guided, evolutionary fuzzing engine.</p>
</blockquote>
<ul>
<li><a class="link" href="https://llvm.org/docs/LibFuzzer.html"  target="_blank" rel="noopener"
    >å®˜æ–¹æ–‡æ¡£</a></li>
<li><a class="link" href="https://github.com/google/fuzzing/blob/master/tutorial/libFuzzerTutorial.md"  target="_blank" rel="noopener"
    >Googleçš„libFuzzeræ•™ç¨‹</a></li>
</ul>
<p>â˜ï¸æ¥ä¸‹æ¥è¯»ä¸€ç»ƒäºŒ</p>
<p>å°†æ•™ç¨‹ä»“åº“cloneä¸‹æ¥ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">git clone https://github.com/google/fuzzing.git fuzzing
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±äºï¼š</p>
<blockquote>
<p>Recent versions of Clang (starting from 6.0) include libFuzzer, and no extra installation is necessary.</p>
</blockquote>
<p>æ‰€ä»¥å¯ä»¥ç›´æ¥æµ‹è¯•ä¸€ä¸‹ç¯å¢ƒæ˜¯å¦å°±ç»ªï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">clang++ -g -fsanitize<span class="o">=</span>address,fuzzer fuzzing/tutorial/libFuzzer/fuzz_me.cc
</span></span><span class="line"><span class="cl">./a.out 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> grep ERROR
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘å¾—åˆ°äº†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="o">==</span><span class="nv">2118349</span><span class="o">==</span>ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200003d473 at pc 0x000000550453 bp 0x7fff521da530 sp 0x7fff521da528
</span></span></code></pre></td></tr></table>
</div>
</div><p>çœ‹æ¥æ²¡é—®é¢˜ï¼Œç»§ç»­å‰è¿›ã€‚</p>
<h2 id="ç«èŠ±å¡æ‰“ç«demoæ‹†è§£">ç«èŠ±å¡æ‰“ç«â€”â€”demoæ‹†è§£</h2>
<p>æ ·ä¾‹ç¨‹åºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1">#include &lt;stdint.h&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#include &lt;stddef.h&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bool FuzzMe<span class="o">(</span>const uint8_t *Data, size_t DataSize<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> DataSize &gt;<span class="o">=</span> <span class="m">3</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">      Data<span class="o">[</span>0<span class="o">]</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">      Data<span class="o">[</span>1<span class="o">]</span> <span class="o">==</span> <span class="s1">&#39;U&#39;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">      Data<span class="o">[</span>2<span class="o">]</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">      Data<span class="o">[</span>3<span class="o">]</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">;</span>  // :â€‘&lt;
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">extern <span class="s2">&#34;C&#34;</span> int LLVMFuzzerTestOneInput<span class="o">(</span>const uint8_t *Data, size_t Size<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  FuzzMe<span class="o">(</span>Data, Size<span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> 0<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨libFuzzeræ—¶æˆ‘ä»¬çš„Fuzzç›®æ ‡æ˜¯ï¼Ÿ</p>
<p>Definition: a <strong>fuzz target</strong> is a function that has the following signature and does something interesting with it&rsquo;s arguments:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">extern</span> <span class="s">&#34;C&#34;</span> <span class="kt">int</span> <span class="n">LLVMFuzzerTestOneInput</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">Data</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">Size</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">DoSomethingWithData</span><span class="p">(</span><span class="n">Data</span><span class="p">,</span> <span class="n">Size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥å¯¹äºæ ·ä¾‹ç¨‹åºï¼Œæˆ‘ä»¬å…ˆå‡†å¤‡å¥½å¾…æµ‹å‡½æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">FuzzMe</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">Data</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">DataSize</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">DataSize</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;F&#39;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;U&#39;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;Z&#39;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;Z&#39;</span><span class="p">;</span>  <span class="c1">// :â€‘&lt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ä¸ºå…¶å‡†å¤‡fuzz wrapperå‡½æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">extern</span> <span class="s">&#34;C&#34;</span> <span class="kt">int</span> <span class="n">LLVMFuzzerTestOneInput</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">Data</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">Size</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">FuzzMe</span><span class="p">(</span><span class="n">Data</span><span class="p">,</span> <span class="n">Size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨ç‰ˆæœ¬6ä»¥ä¸Šçš„clangï¼Œå¼€å¯å¦‚ä¸‹ä¸‰ä¸ªé€‰é¡¹è¿›è¡Œç¼–è¯‘ï¼š</p>
<ul>
<li><code>-fsanitize=fuzzer</code> (required): provides in-process coverage information to libFuzzer and links with the libFuzzer runtime.</li>
<li><code>-fsanitize=address</code> (recommended): enables <a class="link" href="http://clang.llvm.org/docs/AddressSanitizer.html"  target="_blank" rel="noopener"
    >AddressSanitizer</a></li>
<li><code>-g</code> (recommended): enables debug info, makes the error messages easier to read.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">clang</span><span class="o">++</span> <span class="o">-</span><span class="n">g</span> <span class="o">-</span><span class="n">fsanitize</span><span class="o">=</span><span class="n">address</span><span class="p">,</span><span class="n">fuzzer</span> <span class="n">fuzzing</span><span class="o">/</span><span class="n">tutorial</span><span class="o">/</span><span class="n">libFuzzer</span><span class="o">/</span><span class="n">fuzz_me</span><span class="p">.</span><span class="n">cc</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç¼–è¯‘å‡ºçš„ç¨‹åºï¼Œå³è¾“å‡ºäº†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">âœ  fuzzing git:<span class="o">(</span>master<span class="o">)</span> âœ— ./a.out
</span></span><span class="line"><span class="cl">INFO: Seed: <span class="m">122504861</span>
</span></span><span class="line"><span class="cl">INFO: Loaded <span class="m">1</span> modules   <span class="o">(</span><span class="m">7</span> inline 8-bit counters<span class="o">)</span>: <span class="m">7</span> <span class="o">[</span>0x5a6eb0, 0x5a6eb7<span class="o">)</span>,
</span></span><span class="line"><span class="cl">INFO: Loaded <span class="m">1</span> PC tables <span class="o">(</span><span class="m">7</span> PCs<span class="o">)</span>: <span class="m">7</span> <span class="o">[</span>0x56b140,0x56b1b0<span class="o">)</span>,
</span></span><span class="line"><span class="cl">INFO: -max_len is not provided<span class="p">;</span> libFuzzer will not generate inputs larger than <span class="m">4096</span> bytes
</span></span><span class="line"><span class="cl">INFO: A corpus is not provided, starting from an empty corpus
</span></span><span class="line"><span class="cl"><span class="c1">#2      INITED cov: 3 ft: 3 corp: 1/1b exec/s: 0 rss: 27Mb</span>
</span></span><span class="line"><span class="cl"><span class="c1">#3      NEW    cov: 4 ft: 4 corp: 2/5b lim: 4 exec/s: 0 rss: 27Mb L: 4/4 MS: 1 CrossOver-</span>
</span></span><span class="line"><span class="cl"><span class="c1">#13     REDUCE cov: 4 ft: 4 corp: 2/4b lim: 4 exec/s: 0 rss: 27Mb L: 3/3 MS: 5 ChangeBit-ShuffleBytes-ChangeByte-CrossOver-CrossOver-</span>
</span></span><span class="line"><span class="cl"><span class="c1">#446    REDUCE cov: 5 ft: 5 corp: 3/7b lim: 8 exec/s: 0 rss: 27Mb L: 3/3 MS: 3 ChangeByte-CopyPart-CMP- DE: &#34;F\x00&#34;-</span>
</span></span><span class="line"><span class="cl"><span class="c1">#4543   NEW    cov: 6 ft: 6 corp: 4/11b lim: 48 exec/s: 0 rss: 27Mb L: 4/4 MS: 2 InsertByte-ChangeByte-</span>
</span></span><span class="line"><span class="cl"><span class="c1">#4880   REDUCE cov: 6 ft: 6 corp: 4/10b lim: 48 exec/s: 0 rss: 27Mb L: 3/3 MS: 2 ChangeByte-EraseBytes-</span>
</span></span><span class="line"><span class="cl"><span class="c1">#7716   REDUCE cov: 7 ft: 7 corp: 5/14b lim: 74 exec/s: 0 rss: 27Mb L: 4/4 MS: 1 InsertByte-</span>
</span></span><span class="line"><span class="cl"><span class="o">=================================================================</span>
</span></span><span class="line"><span class="cl"><span class="o">==</span><span class="nv">2119678</span><span class="o">==</span>ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000303f3 at pc 0x000000550453 bp 0x7fffcad0db90 sp 0x7fffcad0db88
</span></span><span class="line"><span class="cl">READ of size <span class="m">1</span> at 0x6020000303f3 thread T0
</span></span><span class="line"><span class="cl">    <span class="c1">#0 0x550452 in FuzzMe(unsigned char const*, unsigned long) /root/lab/fuzzing_baby/fuzzing/tutorial/libFuzzer/fuzz_me.cc:9:7</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#1 0x5504f4 in LLVMFuzzerTestOneInput /root/lab/fuzzing_baby/fuzzing/tutorial/libFuzzer/fuzz_me.cc:13:3</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#2 0x458671 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/f/lab/fuzzing_baby/fuzzing/a.out+0x458671)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#3 0x457db5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/f/lab/fuzzing_baby/fuzzing/a.out+0x457db5)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#4 0x45a057 in fuzzer::Fuzzer::MutateAndTestOne() (/f/lab/fuzzing_baby/fuzzing/a.out+0x45a057)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#5 0x45ad55 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, fuzzer::fuzzer_allocator&lt;fuzzer::SizedFile&gt; &gt;&amp;) (/f/lab/fuzzing_baby/fuzzing/</span>
</span></span><span class="line"><span class="cl">a.out+0x45ad55<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#6 0x44970e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/f/lab/fuzzing_baby/fuzzing/a.out+0x44970e)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#7 0x472552 in main (/f/lab/fuzzing_baby/fuzzing/a.out+0x472552)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#8 0x7f9d13710082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#9 0x41e4ad in _start (/f/lab/fuzzing_baby/fuzzing/a.out+0x41e4ad)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0x6020000303f3 is located <span class="m">0</span> bytes to the right of 3-byte region <span class="o">[</span>0x6020000303f0,0x6020000303f3<span class="o">)</span>
</span></span><span class="line"><span class="cl">allocated by thread T0 here:
</span></span><span class="line"><span class="cl">    <span class="c1">#0 0x51e1dd in malloc (/f/lab/fuzzing_baby/fuzzing/a.out+0x51e1dd)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#1 0x432897 in operator new(unsigned long) (/f/lab/fuzzing_baby/fuzzing/a.out+0x432897)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#2 0x457db5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/f/lab/fuzzing_baby/fuzzing/a.out+0x457db5)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#3 0x45a057 in fuzzer::Fuzzer::MutateAndTestOne() (/f/lab/fuzzing_baby/fuzzing/a.out+0x45a057)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#4 0x45ad55 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, fuzzer::fuzzer_allocator&lt;fuzzer::SizedFile&gt; &gt;&amp;) (/f/lab/fuzzing_baby/fuzzing/</span>
</span></span><span class="line"><span class="cl">a.out+0x45ad55<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#5 0x44970e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/f/lab/fuzzing_baby/fuzzing/a.out+0x44970e)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#6 0x472552 in main (/f/lab/fuzzing_baby/fuzzing/a.out+0x472552)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#7 0x7f9d13710082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SUMMARY: AddressSanitizer: heap-buffer-overflow /root/lab/fuzzing_baby/fuzzing/tutorial/libFuzzer/fuzz_me.cc:9:7 in FuzzMe<span class="o">(</span>unsigned char const*, unsigned long
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl">Shadow bytes around the buggy address:
</span></span><span class="line"><span class="cl">  0x0c047fffe020: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
</span></span><span class="line"><span class="cl">  0x0c047fffe030: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
</span></span><span class="line"><span class="cl">  0x0c047fffe040: fa fa fd fa fa fa fd fd fa fa fd fa fa fa fd fa
</span></span><span class="line"><span class="cl">  0x0c047fffe050: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa
</span></span><span class="line"><span class="cl">  0x0c047fffe060: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd <span class="nv">fa</span>
</span></span><span class="line"><span class="cl"><span class="o">=</span>&gt;0x0c047fffe070: fa fa fd fd fa fa fd fd fa fa fd fa fa fa<span class="o">[</span>03<span class="o">]</span>fa
</span></span><span class="line"><span class="cl">  0x0c047fffe080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span class="line"><span class="cl">  0x0c047fffe090: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span class="line"><span class="cl">  0x0c047fffe0a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span class="line"><span class="cl">  0x0c047fffe0b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span class="line"><span class="cl">  0x0c047fffe0c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span class="line"><span class="cl">Shadow byte legend <span class="o">(</span>one shadow byte represents <span class="m">8</span> application bytes<span class="o">)</span>:
</span></span><span class="line"><span class="cl">  Addressable:           <span class="m">00</span>
</span></span><span class="line"><span class="cl">  Partially addressable: <span class="m">01</span> <span class="m">02</span> <span class="m">03</span> <span class="m">04</span> <span class="m">05</span> <span class="m">06</span> <span class="m">07</span>
</span></span><span class="line"><span class="cl">  Heap left redzone:       fa
</span></span><span class="line"><span class="cl">  Freed heap region:       fd
</span></span><span class="line"><span class="cl">  Stack left redzone:      f1
</span></span><span class="line"><span class="cl">  Stack mid redzone:       f2
</span></span><span class="line"><span class="cl">  Stack right redzone:     f3
</span></span><span class="line"><span class="cl">  Stack after <span class="k">return</span>:      f5
</span></span><span class="line"><span class="cl">  Stack use after scope:   f8
</span></span><span class="line"><span class="cl">  Global redzone:          f9
</span></span><span class="line"><span class="cl">  Global init order:       f6
</span></span><span class="line"><span class="cl">  Poisoned by user:        f7
</span></span><span class="line"><span class="cl">  Container overflow:      <span class="nb">fc</span>
</span></span><span class="line"><span class="cl">  Array cookie:            ac
</span></span><span class="line"><span class="cl">  Intra object redzone:    bb
</span></span><span class="line"><span class="cl">  ASan internal:           fe
</span></span><span class="line"><span class="cl">  Left alloca redzone:     ca
</span></span><span class="line"><span class="cl">  Right alloca redzone:    cb
</span></span><span class="line"><span class="cl">  Shadow gap:              <span class="nv">cc</span>
</span></span><span class="line"><span class="cl"><span class="o">==</span><span class="nv">2119678</span><span class="o">==</span>ABORTING
</span></span><span class="line"><span class="cl">MS: <span class="m">1</span> EraseBytes-<span class="p">;</span> base unit: 9a96b9fc7e2f4543fde6948573fd8bb47ec80fd0
</span></span><span class="line"><span class="cl">0x46,0x55,0x5a,
</span></span><span class="line"><span class="cl">FUZ
</span></span><span class="line"><span class="cl"><span class="nv">artifact_prefix</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">;</span> Test unit written to ./crash-0eb8e4ed029b774d80f2b66408203801cb982a60
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŒæ—¶ç”Ÿæˆäº†è§¦å‘å¦‚ä¸Šcrashçš„è¾“å…¥crash-0eb8e4ed029b774d80f2b66408203801cb982a60ï¼Œå†…å®¹ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">âœ  fuzzing git:<span class="o">(</span>master<span class="o">)</span> âœ— hd crash-0eb8e4ed029b774d80f2b66408203801cb982a60
</span></span><span class="line"><span class="cl"><span class="m">00000000</span>  <span class="m">46</span> <span class="m">55</span> 5a                                          <span class="p">|</span>FUZ<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="m">00000003</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨å…¶å¤ç°æ¼æ´ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">./a.out &lt; crash-0eb8e4ed029b774d80f2b66408203801cb982a60
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±æ­¤ä¾¿æ˜¯å€ŸåŠ©libFuzzerå®Œæˆçš„æœ€ç®€å•çš„Fuzzingä¸æ‰¾åˆ°çš„æ¼æ´ã€‚</p>
<h2 id="ä¸‹èµ›é“åçš„å¤ç›˜fuzzingè¾“å‡ºè§£æ">ä¸‹èµ›é“åçš„å¤ç›˜â€”â€”fuzzingè¾“å‡ºè§£æ</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">INFO: Seed: <span class="m">3918206239</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The fuzzer has started with this random seed. Rerun it with <code>-seed=3918206239</code> to get the same result.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">INFO: -max_len is not provided<span class="p">;</span> libFuzzer will not generate inputs larger than <span class="m">4096</span> bytes
</span></span><span class="line"><span class="cl">INFO: A corpus is not provided, starting from an empty corpus
</span></span></code></pre></td></tr></table>
</div>
</div><p>By default, libFuzzer assumes that all inputs are 4096 bytes or smaller. To change that either use <code>-max_len=N</code> or run with a non-empty <a class="link" href="https://github.com/google/fuzzing/blob/master/tutorial/libFuzzerTutorial.md#seed-corpus"  target="_blank" rel="noopener"
    >seed corpus</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1">#0      READ units: 1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#1      INITED cov: 3 ft: 3 corp: 1/1b exec/s: 0 rss: 26Mb</span>
</span></span><span class="line"><span class="cl"><span class="c1">#8      NEW    cov: 4 ft: 4 corp: 2/29b exec/s: 0 rss: 26Mb L: 28 MS: 2 InsertByte-InsertRepeatedBytes-</span>
</span></span><span class="line"><span class="cl"><span class="c1">#3405   NEW    cov: 5 ft: 5 corp: 3/82b exec/s: 0 rss: 27Mb L: 53 MS: 4 InsertByte-EraseBytes-...</span>
</span></span><span class="line"><span class="cl"><span class="c1">#8664   NEW    cov: 6 ft: 6 corp: 4/141b exec/s: 0 rss: 27Mb L: 59 MS: 3 CrossOver-EraseBytes-...</span>
</span></span><span class="line"><span class="cl"><span class="c1">#272167 NEW    cov: 7 ft: 7 corp: 5/201b exec/s: 0 rss: 51Mb L: 60 MS: 1 InsertByte-</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>libFuzzer has tried at least 272167 inputs (<code>#272167</code>) and has discovered 5 inputs of 201 bytes total (<code>corp: 5/201b</code>) that together cover 7 <em>coverage points</em> (<code>cov: 7</code>). You may think of coverage points as of <a class="link" href="https://en.wikipedia.org/wiki/Basic_block"  target="_blank" rel="noopener"
    >basic blocks</a> in the code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="o">==</span><span class="nv">2335</span><span class="o">==</span>ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000155c13 at pc 0x0000004ee637...
</span></span><span class="line"><span class="cl">READ of size <span class="m">1</span> at 0x602000155c13 thread T0
</span></span><span class="line"><span class="cl">    <span class="c1">#0 0x4ee636 in FuzzMe(unsigned char const*, unsigned long) fuzzing/tutorial/libFuzzer/fuzz_me.cc:10:7</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#1 0x4ee6aa in LLVMFuzzerTestOneInput fuzzing/tutorial/libFuzzer/fuzz_me.cc:14:3</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>On one of the inputs AddressSanitizer has detected a <code>heap-buffer-overflow</code> bug and aborted the execution.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nv">artifact_prefix</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">;</span> Test unit written to ./crash-0eb8e4ed029b774d80f2b66408203801cb982a60
</span></span></code></pre></td></tr></table>
</div>
</div><p>Before exiting the process libFuzzer has created a file on disc with the bytes that triggered the crash.</p>
<h2 id="é©¾æ ¡å®ä¹ cve-2014-0160">é©¾æ ¡å®ä¹ â€”â€”CVE-2014-0160</h2>
<p><a class="link" href="/post/cve-2014-0160/" >è§CVE-2014-0160åˆ†æ</a></p>
<h2 id="ç§å­è¯­æ–™åº“">ç§å­è¯­æ–™åº“</h2>
<p>ä½¿ç”¨è°·æ­Œçš„æ•™ç¨‹ä»“åº“å®éªŒï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">git clone https://github.com/google/fuzzer-test-suite.git
</span></span><span class="line"><span class="cl">mkdir woff<span class="p">;</span> <span class="nb">cd</span> woff<span class="p">;</span>
</span></span><span class="line"><span class="cl">../fuzzer-test-suite/woff2-2016-05-06/build.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¼€å§‹è¿è¡Œfuzzerï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">./woff2-2016-05-06-fsanitize_fuzzer 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Most likely you will see that the fuzzer is stuck &ndash; it is running millions of inputs but can not find many new code paths.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1">#1      INITED cov: 18 ft: 15 corp: 1/1b exec/s: 0 rss: 27Mb</span>
</span></span><span class="line"><span class="cl"><span class="c1">#15     NEW    cov: 23 ft: 16 corp: 2/5b exec/s: 0 rss: 27Mb L: 4 MS: 4 InsertByte-...</span>
</span></span><span class="line"><span class="cl"><span class="c1">#262144 pulse  cov: 23 ft: 16 corp: 2/5b exec/s: 131072 rss: 45Mb</span>
</span></span><span class="line"><span class="cl"><span class="c1">#524288 pulse  cov: 23 ft: 16 corp: 2/5b exec/s: 131072 rss: 62Mb</span>
</span></span><span class="line"><span class="cl"><span class="c1">#1048576        pulse  cov: 23 ft: 16 corp: 2/5b exec/s: 116508 rss: 97Mb</span>
</span></span><span class="line"><span class="cl"><span class="c1">#2097152        pulse  cov: 23 ft: 16 corp: 2/5b exec/s: 110376 rss: 167Mb</span>
</span></span><span class="line"><span class="cl"><span class="c1">#4194304        pulse  cov: 23 ft: 16 corp: 2/5b exec/s: 107546 rss: 306Mb</span>
</span></span><span class="line"><span class="cl"><span class="c1">#8388608        pulse  cov: 23 ft: 16 corp: 2/5b exec/s: 106184 rss: 584Mb</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The first step you should make in such case is to find some inputs that trigger enough code paths &ndash; the more the better. The woff2 fuzz target consumes web fonts in <code>.woff2</code> format and so you can just find any such file(s). The build script you have just executed has downloaded a project with some <code>.woff2</code> files and placed it into the directory <code>./seeds/</code>. Inspect this directory. What do you see? Are there any <code>.woff2</code> files?</p>
<p>Now you can use the woff2 fuzzer with a seed corpus. Do it like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">mkdir MY_CORPUS
</span></span><span class="line"><span class="cl">./woff2-2016-05-06-fsanitize_fuzzer MY_CORPUS/ seeds/
</span></span></code></pre></td></tr></table>
</div>
</div><p>When a libFuzzer-based fuzzer is executed with one more directory as arguments, it will first read files from every directory recursively and execute the target function on all of them. Then, any input that triggers interesting code path(s) will be written back into the first corpus directory (in this case, <code>MY_CORPUS</code>).</p>
<p>Let us look at the output:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">INFO: Seed: <span class="m">3976665814</span>
</span></span><span class="line"><span class="cl">INFO: Loaded <span class="m">1</span> modules   <span class="o">(</span><span class="m">9611</span> inline 8-bit counters<span class="o">)</span>: <span class="m">9611</span> <span class="o">[</span>0x93c710, 0x93ec9b<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">INFO: Loaded <span class="m">1</span> PC tables <span class="o">(</span><span class="m">9611</span> PCs<span class="o">)</span>: <span class="m">9611</span> <span class="o">[</span>0x6e8628,0x70ded8<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">INFO:        <span class="m">0</span> files found in MY_CORPUS/
</span></span><span class="line"><span class="cl">INFO:       <span class="m">62</span> files found in seeds/
</span></span><span class="line"><span class="cl">INFO: -max_len is not provided<span class="p">;</span> libFuzzer will not generate inputs larger than <span class="m">168276</span> bytes
</span></span><span class="line"><span class="cl">INFO: seed corpus: files: <span class="m">62</span> min: 14b max: 168276b total: 3896056b rss: 37Mb
</span></span><span class="line"><span class="cl"><span class="c1">#63     INITED cov: 632 ft: 1096 corp: 13/766Kb exec/s: 0 rss: 61Mb</span>
</span></span><span class="line"><span class="cl">        NEW_FUNC<span class="o">[</span>0/1<span class="o">]</span>: 0x5aae80 in TransformDictionaryWord...
</span></span><span class="line"><span class="cl"><span class="c1">#64     NEW    cov: 651 ft: 1148 corp: 14/832Kb exec/s: 0 rss: 63Mb L: 67832/68784 MS: 1 ChangeBinInt-</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="c1">#535    NEW    cov: 705 ft: 1620 corp: 48/3038Kb exec/s: 0 rss: 162Mb L: 68784/68784 MS: 1 ChangeBinInt-</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="c1">#288595 NEW    cov: 839 ft: 2909 corp: 489/30Mb exec/s: 1873 rss: 488Mb L: 62832/68784 MS: 1 ShuffleBytes-</span>
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><p>As you can see, the initial coverage is much greater than before (<code>INITED cov: 632</code>) and it keeps growing.</p>
<p>The size of the inputs that libFuzzer tries is now limited by 168276, which is the size of the largest file in the seed corpus. You may change that with <code>-max_len=N</code>.</p>
<p>You may interrupt the fuzzer at any moment and restart it using the same command line. It will start from where it stopped.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/fuzzing/">Fuzzing</a>
        
    </section>


    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/post/zkv%E7%9A%84cc-%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/">
        
        
            <div class="article-image">
                
                    <img src="https://s2.loli.net/2022/08/09/FTvgEfriYsZ2a9L.png" loading="lazy" data-key="" data-hash="https://s2.loli.net/2022/08/09/FTvgEfriYsZ2a9L.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ZKVçš„Cã€C&#43;&#43;æ„å»ºç³»ç»Ÿå­¦ä¹ ä¹‹è·¯</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/zkv%E5%AF%B9%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%A1%AC%E4%BB%B6%E7%9A%84%E6%B5%85%E5%B0%9D%E4%B8%8D%E6%AD%A2/">
        
        
            <div class="article-image">
                
                    <img src="https://pic1.zhimg.com/v2-983af8971091bf560af2e2299d801cd1_1440w.jpg" loading="lazy" data-key="" data-hash="https://pic1.zhimg.com/v2-983af8971091bf560af2e2299d801cd1_1440w.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ZKVå¯¹åµŒå…¥å¼ç¡¬ä»¶çš„æµ…å°ä¸æ­¢</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/zkv%E5%AF%B9%E5%90%8E%E7%AB%AF%E7%9A%84%E6%B5%85%E5%B0%9D%E8%BE%84%E6%AD%A2/">
        
        
            <div class="article-image">
                
                    <img src="https://pic4.zhimg.com/v2-3ec9f9b98b4c3596e09b40d143410f0e_1440w.jpg?source=172ae18b" loading="lazy" data-key="" data-hash="https://pic4.zhimg.com/v2-3ec9f9b98b4c3596e09b40d143410f0e_1440w.jpg?source=172ae18b"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ZKVå¯¹åç«¯çš„æµ…å°è¾„æ­¢</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/zkv%E7%9A%84linux-kernel%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/">
        
        
            <div class="article-image">
                
                    <img src="https://s2.loli.net/2022/06/13/9o2jpBPbfcLRMFT.jpg" loading="lazy" data-key="" data-hash="https://s2.loli.net/2022/06/13/9o2jpBPbfcLRMFT.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ZKVçš„Linux Kernelå­¦ä¹ ä¹‹è·¯</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2022 LanikeA
    </section>
    
    <section class="powerby">
        
            All Rights Abandoned. <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.13.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#x00-æ—©æ•™æ•™ç¨‹">\x00 æ—©æ•™æ•™ç¨‹</a>
      <ol>
        <li><a href="#æ•™ç¨‹">æ•™ç¨‹</a></li>
        <li><a href="#è¯¾ç¨‹">è¯¾ç¨‹</a></li>
        <li><a href="#åšæ–‡">åšæ–‡</a></li>
        <li><a href="#ç»ƒå…µåœº">ç»ƒå…µåœº</a></li>
        <li><a href="#å…µå™¨">å…µå™¨</a></li>
        <li><a href="#èµ„æº">èµ„æº</a></li>
        <li><a href="#è®ºæ–‡">è®ºæ–‡</a>
          <ol>
            <li><a href="#å¼€å±±">å¼€å±±</a></li>
            <li><a href="#èµ„æ–™">èµ„æ–™</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#x01-å­¦æ­¥è½¦aflåˆæ¢">\x01 å­¦æ­¥è½¦AFLåˆæ¢</a>
      <ol>
        <li><a href="#æœ€ç®€å•çš„-fuzzing-demo">æœ€ç®€å•çš„ fuzzing demo</a></li>
        <li><a href="#ä¸ºå­¦æ­¥è½¦è£…ä¸Šåä¸ºsanitizersçš„è½®å­">ä¸ºå­¦æ­¥è½¦è£…ä¸Šåä¸ºsanitizersçš„è½®å­</a></li>
        <li><a href="#é»‘ç›’æµ‹è¯•qemu-modeæ‹†èµ°æºç ã®è½®å„¿">é»‘ç›’æµ‹è¯•QEMU modeâ€”â€”æ‹†èµ°æºç ã®è½®å„¿</a></li>
        <li><a href="#aflå¹¶å‘å­¦æ­¥è½¦çš„å››ç¼¸å¼•æ“">AFLå¹¶å‘â€”â€”å­¦æ­¥è½¦çš„å››ç¼¸å¼•æ“</a></li>
        <li><a href="#fuzzing-capstone-using-afl-persistent-mode">Fuzzing capstone using AFL persistent mode</a></li>
      </ol>
    </li>
    <li><a href="#x02-libfuzzeråˆæ¢">\x02 libFuzzeråˆæ¢</a>
      <ol>
        <li><a href="#ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</a></li>
        <li><a href="#ç«èŠ±å¡æ‰“ç«demoæ‹†è§£">ç«èŠ±å¡æ‰“ç«â€”â€”demoæ‹†è§£</a></li>
        <li><a href="#ä¸‹èµ›é“åçš„å¤ç›˜fuzzingè¾“å‡ºè§£æ">ä¸‹èµ›é“åçš„å¤ç›˜â€”â€”fuzzingè¾“å‡ºè§£æ</a></li>
        <li><a href="#é©¾æ ¡å®ä¹ cve-2014-0160">é©¾æ ¡å®ä¹ â€”â€”CVE-2014-0160</a></li>
        <li><a href="#ç§å­è¯­æ–™åº“">ç§å­è¯­æ–™åº“</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
